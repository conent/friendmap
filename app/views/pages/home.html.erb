
<%- content_for(:head) do -%>
<%= javascript_include_tag :defaults -%>

<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?&sensor=false">
</script>
<script type="text/javascript">
  function initialize() {
  	var markers = <%= @markers %>;
  	alert(markers);
  	var mypos= new google.maps.LatLng(0, 0);
    if(navigator.geolocation) {
    		navigator.geolocation.getCurrentPosition(function(position) {
    	  	var pos = new google.maps.LatLng(position.coords.lat, position.coords.lng);
		    }, function() {
	      		handleNoGeolocation(true);
    			});
	  } else {
    	// Browser doesn't support Geolocation
   		handleNoGeolocation(false);
  	}

  	function handleNoGeolocation(errorFlag) {
	 	  if (errorFlag) {
 		    var content = 'Error: The Geolocation service failed.';
 	  	} else {
 	    	var content = 'Error: Your browser doesn\'t support geolocation.';
 	  	}
   	}

    var mapOptions = {
      center: new google.maps.LatLng(mypos.lat(), mypos.lng()),
      zoom: 3,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"),mapOptions);
    setMapMarkers(map);
  }
  google.maps.event.addDomListener(window, 'load', initialize);

  function setMapMarkers(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}
 

</script>

<%- end -%>

<h1>Pages#home</h1>


<p>here will be a map if user is loged in otherwise a "what is friendmap?" page</p>

<p>
    <%= link_to "Sign Up Now!", new_friend_registration_path, class: "btn btn-primary btn-large" %>
</p>
<button type="button" onclick="myFunction()">Try it</button>
<!-- <div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div> -->
<p id="mypos"><p>
<div id="map-canvas"style="width: 800px; height: 400px;"></div>

<script type="text/javascript">
// 	handler = Gmaps.build('Google');
// 	handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
// 	  markers = handler.addMarkers(<%=raw @hash.to_json %>);
// 	  handler.bounds.extendWith(markers);
// 	  handler.fitMapToBounds();
// 	});
// 	if(navigator.geolocation) {
//     navigator.geolocation.getCurrentPosition(function(position) {
//       var pos = new google.maps.LatLng(position.coords.latitude,
//                                        position.coords.longitude);
//       handler.map.centerOn(pos);

//     }, function() {
//       handleNoGeolocation(true);
//     });
//   } else {
//     // Browser doesn't support Geolocation
//     handleNoGeolocation(false);
//   }
// 	      map.setCenter(pos);
//       map.setZoom(13);

// 	function handleNoGeolocation(errorFlag) {
// 	  if (errorFlag) {
// 	    var content = 'Error: The Geolocation service failed.';
// 	  } else {
// 	    var content = 'Error: Your browser doesn\'t support geolocation.';
// 	  }
//   }
// </script>





<!-- <%= session.inspect %> -->